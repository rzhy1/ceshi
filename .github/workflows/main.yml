name: "测试"
#dsafghj
on:
  workflow_dispatch:
  push:
    branches:
      - "*"
  pull_request:
    branches:
      - "*"
  release:
    types:
      - released
  schedule:
    - cron: "0 0 * * *"
jobs:
  build:
    runs-on: ubuntu-24.04
    steps:
      - name: Find and configure fastest Ubuntu mirror
        run: |
          wget http://ftp.de.debian.org/debian/pool/main/n/netselect/netselect_0.3.ds1-29_amd64.deb

          # 安装下载的包
          sudo dpkg -i netselect_0.3.ds1-29_amd64.deb
          
          # 如果安装过程中出现依赖问题，运行以下命令修复：
          sudo apt-get -f install
          # 获取镜像列表并测试最快的一个
          FASTEST=$(wget -qO- mirrors.ubuntu.com/mirrors.txt | xargs -n1 | netselect -s1 -t20 2>/dev/null | awk '{print $2}' | head -n1)

          # 如果没找到，给个默认值
          if [ -z "$FASTEST" ]; then
            FASTEST="archive.ubuntu.com"
          fi

          # 🌟 直接在界面高亮显示结果
          echo "✅ 最快的源是: $FASTEST"

          # 可选：在 GitHub Actions Job Summary 里加个醒目显示
          echo "## 🏆 最快 Ubuntu 镜像源" >> $GITHUB_STEP_SUMMARY
          echo "**→ \`$FASTEST\`**" >> $GITHUB_STEP_SUMMARY
